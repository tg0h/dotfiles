# TODO: prefix '.' doesn't seem to be working, how to create a .filename alias with
# a glob pattern?
# TODO: see https://github.com/rafi/.config for a solution to how to store secrets!
# TODO: recursive globbing should not match deep dirs, only files
- defaults:
    link:
      # create directories to create symlink if needed
      create: true
      # removes the old target if it's a symlink 
      relink: true
      # TODO: is default glob to true a good idea?
      glob: true

# remove dead symbolic links from the ~ directory
# only removes links that point to the dotfiles dir, unless the force option is true
- clean:
    ~/:
      force: true # remove dead links even if they don't point to the dotfiles dir
    ~/.config:
      recursive: true

- create:
  - $XDG_DATA_HOME/z # for z to store its frecency dir list
  - $XDG_DATA_HOME/android
  - $XDG_CONFIG_HOME/parallel
  - $XDG_CONFIG_HOME/sqlite3
  - $XDG_CACHE_HOME/tealdeer

# <target>:<source (original file)>
# if linking directories, do not include a trailing slash
- link:
    # do not symlink the config folder directly.
    # eg, if we do this for nvim, nvim will create other files in the nvim config
    # folder which will then appear in my dotfiles repo :|
    ~/.config/: 
      path: config/*/**
      exclude: 
        - config/cheat/cheatsheets
        - config/ssh/*
        - config/zsh/**

    ~/.zshenv: config/zsh/boot.zshenv
    # zsh reads the dot files in the $ZDOTDIR dir
    ~/.config/zsh/.zshenv: config/zsh/zshenv
    ~/.config/zsh/.zprofile: config/zsh/zprofile
    ~/.config/zsh/.zshrc: config/zsh/zshrc
    ~/.config/zsh/p10k: config/zsh/p10k

    ~/.ssh/: 
      path: config/ssh/*

    # Unlike the config folder, I just symlink the child folders because I am  
    # confident that the directories here won't have other files added
    ~/.local/lib/: lib/*
    ~/.local/lib/abs: ~/src/me/abs/abs
    ~/.local/lib/zsh_functions: lib/zsh_functions/ #autoload function directory

    ~/Library/Application Support/com.clickontyler.TextBuddy/scripts: share/textBuddy/

    # certis
    ~/src/certis/edo/abc-cli/config/environment/: config/abc-cli/env/*
    ~/Library/LaunchAgents/certify-verifysync.plist: lib/certify/certify-verifysync.plist #certify sync job
    # me
    ~/src/me/timtoggl/timtoggl/.env: config/timtoggl/secret/env
