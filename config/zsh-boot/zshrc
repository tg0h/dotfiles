# place the homebrew binaries at the end of path, if not nvm will always point to the homebrew system node (if you install anything in homebrew that needs node as a depedency)
export PATH="$PATH:/opt/homebrew/bin"
export PATH="$PATH:$HOME/.local/bin"

# zmodload zsh/zprof - turn this on to profile zshrc, run zprof at end as well
# zprof - turn this on at the end of zshrc to profile zshrc

export ZSH="$XDG_DATA_HOME/oh-my-zsh"
# set up p10k prompt
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

ZSH_THEME="powerlevel10k/powerlevel10k"
export KEYTIMEOUT=1 # Make Vi mode transitions faster (KEYTIMEOUT is in hundredths of a second)
export EDITOR='nvim'
export NVM_AUTO_USE=true # zsh-nvm plugin autoloads .nvmrc, set before the plugins array
export NVM_LAZY_LOAD=true  # zsh-nvm lazy load
ZSH_EVALCACHE_DIR=$XDG_CACHE_HOME/zsh-evalcache

plugins=(
  zsh-nvm # add at the top so other plugins that use node/npm can work
  evalcache
  aws colored-man-pages docker docker-compose dotenv
  git git-auto-fetch gitignore last-working-dir timer 
  zsh-autosuggestions zsh-autocomplete z fast-syntax-highlighting 
)

bindkey -v # use vim keymap for zsh

# CONFIG
source $XDG_CONFIG_HOME/zsh/start/SOURCEME.zsh # source oh-my-zsh and other custom plugins
setopt EXTENDED_GLOB # use ~ to exclude patterns in file globbing
for f in $XDG_CONFIG_HOME/zsh/***/*.zsh~*/start/*; do {source $f} done # exclude start/
fpath=($HOME/.local/lib/zsh/***/*~*/archive*(/) $fpath) # / matches directories, exclude archive/
# FUNCTIONS
# for f in $HOME/.local/lib/zsh/***/start/*(.); do {source $f} done # exclude start/
for func in $HOME/.local/lib/zsh/***/*~(*/archive/*|*.zsh)(.); do {autoload $func} done
unsetopt EXTENDED_GLOB

# enable aws completion - https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-completion.html
# complete -C '/usr/local/bin/aws_completer' aws 
_evalcache pyenv init - # instead of eval $(pyenv init -)
_evalcache thefuck --alias # instead of eval $(thefuck --alias)
# . `which env_parallel.zsh` # load env parallel

autoload zmv # so i can use zmv immediately
